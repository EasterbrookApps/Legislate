# SIs from the start of the current Parliament (last election: 2024-07-04) to today
PREFIX :   <https://id.parliament.uk/schema/>
PREFIX id: <https://id.parliament.uk/>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>

SELECT DISTINCT ?workPackage ?title ?laidDate ?procedureKind ?procedureScrutiny ?legislationURI ?departmentLabel
WHERE {
  ?workPackage a :WorkPackage ;
               :workPackagedThing ?thing .
  ?thing a :StatutoryInstrument .

  OPTIONAL { ?thing :preferredLabel ?title . }

  # Any "Laid before the House ..." business item date
  OPTIONAL {
    ?laidBI a :BusinessItem ;
            :workPackagedThing ?thing ;
            :businessItemHasProcedureStep ?laidStep ;
            :businessItemDate ?laidDate .
    ?laidStep :preferredLabel ?laidLabel .
    FILTER ( CONTAINS(LCASE(?laidLabel), "laid before the house") )
  }

  OPTIONAL {
    ?workPackage :hasProcedure ?proc .
    OPTIONAL { ?proc :procedureKind ?procedureKind . }
    OPTIONAL { ?proc :procedureRouteScrutiny ?procedureScrutiny . }
  }

  OPTIONAL {
    ?thing :layingBody ?dept .
    ?dept  :preferredLabel ?departmentLabel .
  }

  OPTIONAL { ?thing :workPackageableThingHasLegislationURL ?legislationURI . }

  # Filter from last General Election to today
  FILTER (BOUND(?laidDate) && ?laidDate >= "2024-07-04"^^xsd:date)
}
ORDER BY DESC(?laidDate)
