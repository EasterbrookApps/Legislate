(function(){const D=window.LegislateDebug,UI=window.LegislateUI,Loader=window.LegislateLoader;
function showBanner(msg){const bar=document.getElementById('errorBanner');const txt=document.getElementById('errorBannerText');const btn=document.getElementById('errorBannerDismiss');if(txt)txt.textContent=msg;if(bar)bar.hidden=false;btn?.addEventListener('click',()=>{if(bar)bar.hidden=true;});}
window.onerror=function(message,source,lineno,colno,error){D?.error?.('window.onerror',{message,source,lineno,colno,error:String(error)});showBanner(`Error: ${message}`);};
window.onunhandledrejection=function(ev){const reason=(ev&&ev.reason)?String(ev.reason):'unhandled rejection';D?.error?.('unhandledrejection',{reason});showBanner(`Error: ${reason}`);};
function requireGlobals(){const missing=[];if(!D)missing.push('Debug');if(!Loader)missing.push('Loader');if(!UI)missing.push('UI');if(missing.length){const msg='Missing globals: '+missing.join(', ');D?.error?.('BOOT_FAIL',{msg});showBanner(msg);return false;}return true;}
function onReady(){try{D.mount();if(!requireGlobals())return;D.event('BOOT_OK');UI.setTurnIndicator("Ready â€” Step 1 boot ok");document.getElementById('rollBtn')?.addEventListener('click',()=>{D.log('rollBtn click');const val=1+Math.floor(Math.random()*6);D.event('DICE_ROLL',{value:val});UI.showDiceRoll(val);});document.getElementById('restartBtn')?.addEventListener('click',()=>D.log('restartBtn click'));document.getElementById('playerCount')?.addEventListener('change',e=>D.log('playerCount change',{value:e.target.value}));}catch(e){D?.error?.('BOOT_FAIL',{error:String(e)});showBanner('Boot failed: '+String(e));}}
if(document.readyState==='complete'||document.readyState==='interactive'){setTimeout(onReady,0);}else{document.addEventListener('DOMContentLoaded',onReady);} })();