import { fetchJSON } from './util.js'; export const Cards={ decks:{} };
export async function loadDecks(){ const ids=['early','commons','lords','implementation','pingpong']; Cards.decks={}; for(const id of ids){ try{ const arr=await fetchJSON('data/cards/'+id+'.json'); if(!Array.isArray(arr)) throw new Error('bad deck'); Cards.decks[id]={draw:arr.slice(),discard:[]}; }catch(e){ console.warn('Deck failed or missing:',id,e.message); Cards.decks[id]={draw:[],discard:[]}; } } }
export function drawFrom(deckId){ const d=Cards.decks[deckId]; if(!d) return null; if(d.draw.length===0){ d.draw=d.discard.slice(); d.discard=[]; } const card=d.draw.shift()||null; if(card) d.discard.push(card); return card; }
export function showCard(deckId, card){ let modal=document.getElementById('card-modal'); if(!modal){ modal=document.createElement('div'); modal.id='card-modal'; modal.className='overlay'; modal.innerHTML='<div class="card card-modal"><div id="card-header"></div><div id="card-text"></div><button id="card-ok" class="btn">OK</button></div>'; document.body.appendChild(modal); }
  modal.classList.remove('hidden'); document.getElementById('card-header').textContent=deckId[0].toUpperCase()+deckId.slice(1); document.getElementById('card-text').textContent=card.text||'â€”'; document.getElementById('card-ok').onclick=()=>{ modal.classList.add('hidden'); }; }